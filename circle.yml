machine:
  timezone: Asia/Tokyo

deployment:
  release:
    tag: /^v[0-9]+(\.[0-9]+)*$/
    commands:
      - go get github.com/mitchellh/gox
      - go get github.com/tcnksm/ghr
      - gox -osarch "linux/amd64 linux/arm darwin/amd64 windows/amd64" -output "dist/{{.OS}}_{{.Arch}}/{{.Dir}}"
      - mkdir dist/zips
      - for ARCH in `ls dist`; do zip -j -o dist/zips/bingo_$ARCH.zip dist/$ARCH/bingo*; done 
      - ghr -t ${GITHUB_TOKEN} -u ${USERNAME} -r ${CIRCLE_PROJECT_REPONAME} --replace `git describe --tags` dist/zips/

